<form role="form" (submit)="saveChanges()" [formGroup]="editProfileFormGroup">
  <div class="form-fields"
       fxLayout="row wrap"
       fxLayoutAlign="start center"
       fxLayoutGap="0"
       fxLayoutGap.gt-xs="16px grid">
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>First Name</mat-label>
        <input matInput
               id="firstName"
               name="firstName"
               formControlName="firstName" />
        <mat-error *ngIf="editProfileFormGroup.controls['firstName'].hasError('required')" i18n>First Name required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>Last Name</mat-label>
        <input matInput
               id="lastName"
               name="lastName"
               formControlName="lastName" />
        <mat-error *ngIf="editProfileFormGroup.controls['lastName'].hasError('required')" i18n>Last Name required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field fxFlex appearance="fill">
        <mat-label i18n>Username</mat-label>
        <input matInput
               id="username"
               name="username"
               formControlName="username" />
        <mat-error *ngIf="editProfileFormGroup.controls['username'].hasError('required')" i18n>User Name required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>Display Name</mat-label>
        <input matInput
               id="displayName"
               name="displayName"
               formControlName="displayName" />
        <mat-hint i18n>This is the name your students will see.</mat-hint>
        <mat-error *ngIf="editProfileFormGroup.controls['lastName'].hasError('required')" i18n>Display Name required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>Email</mat-label>
        <input matInput
               id="email"
               name="email"
               formControlName="email" />
        <mat-hint i18n *ngIf="user.isGoogleUser">If you want to change your email, unlink your Google account.</mat-hint>
        <mat-error *ngIf="editProfileFormGroup.controls['email'].hasError('required')" i18n>Email required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>City</mat-label>
        <input matInput
               id="city"
               name="city"
               formControlName="city" />
        <mat-error *ngIf="editProfileFormGroup.controls['city'].hasError('required')" i18n>City required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>State</mat-label>
        <input matInput
               id="state"
               name="state"
               formControlName="state" />
        <mat-error *ngIf="editProfileFormGroup.controls['state'].hasError('required')" i18n>State required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>Country</mat-label>
        <input matInput
               id="country"
               name="country"
               formControlName="country" />
        <mat-error *ngIf="editProfileFormGroup.controls['country'].hasError('required')" i18n>Country required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>School Name</mat-label>
        <input matInput
               id="schoolName"
               name="schoolName"
               formControlName="schoolName" />
        <mat-error *ngIf="editProfileFormGroup.controls['schoolName'].hasError('required')" i18n>School Name required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>School Level</mat-label>
        <mat-select formControlName="schoolLevel">
          <mat-option *ngFor="let schoolLevel of schoolLevels" [value]="schoolLevel.id">
            {{schoolLevel.label}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="editProfileFormGroup.controls['schoolLevel'].hasError('required')" i18n>School Level required</mat-error>
      </mat-form-field>
    </p>
    <p fxFlex="100" fxFlex.gt-xs="50">
      <mat-form-field appearance="fill" fxFlex>
        <mat-label i18n>Language</mat-label>
        <mat-select formControlName="language">
          <mat-option *ngFor="let language of languages" [value]="language.locale">
            {{language.language}}
          </mat-option>
        </mat-select>
        <mat-hint i18n>Help us translate WISE! Visit <a href="https://crowdin.com/project/wise" target="_blank">https://crowdin.com/project/wise</a>.</mat-hint>
        <mat-error *ngIf="editProfileFormGroup.controls['language'].hasError('required')" i18n>
          Language required
        </mat-error>
      </mat-form-field>
    </p>
  </div>
  <div class="actions"
      fxLayout="column"
      fxLayout.gt-sm="row"
      fxLayoutAlign="center start"
      fxLayoutAlign.gt-sm="start center"
      fxLayoutGap="24px">
    <button mat-raised-button
            color="primary"
            type="submit"
            [disabled]="!editProfileFormGroup.valid || !changed || isSaving">
      <mat-progress-bar mode="indeterminate" *ngIf="isSaving"></mat-progress-bar>
      <ng-container i18n>Save Changes</ng-container>
    </button>
    <div *ngIf="user.isGoogleUser" 
        fxLayout="row wrap"
        fxLayoutAlign="start center"
        fxLayoutGap="8px">
      <div fxLayoutAlign="start center" fxLayoutGap="8px">
        <img class="google-icon" src="assets/img/icons/g-logo.png" i18n-alt alt="Google logo" />
        <span i18n>This profile is linked to a Google account.</span>
      </div>
      <button class="unlink" type="button" mat-raised-button (click)="unlinkGoogleAccount()">
        <span class="warn" i18n>Unlink Google Account</span>
      </button>
    </div>
  </div>
</form>
